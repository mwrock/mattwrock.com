<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<post>
  <author>mwrock</author>
  <title>Setup a new machine with just a URL and Chocolatey package</title>
  <description />
  <content>&lt;p&gt;When I first started working on &lt;a href="http://boxstarter.org/"&gt;Boxstarter&lt;/a&gt;, a set of scripts that can stand up a complete, customized windows environment in a completely unattended manner, one of my key objectives was to be able to spin up a new environment with as few bits on hand as possible. Until now, Boxstarter achieved this by allowing you to create a portable Chocolatey package on a thumb drive or network share. I have never really been satisfied with that. It always seems when the time comes and I want to repave, that thumb drive or share is not around or in an up to date state. What I really want is just to type something brief and rememberable that would bring down all the bits I need to perform the setup (at least solving the &amp;ldquo;not around&amp;rdquo; part). This is now a reality.&lt;/p&gt;
&lt;h2&gt;Introducing The Boxstarter Click-Once Web Launcher&lt;/h2&gt;
&lt;p&gt;You can use any browser that supports Click Once applications. This is limited to IE unless you add extensions to &lt;a href="https://chrome.google.com/webstore/detail/clickonce-for-google-chro/eeifaoomkminpbeebjdmdojbhmagnncl?hl=en"&gt;Chrome&lt;/a&gt; or &lt;a href="https://addons.mozilla.org/en-us/firefox/addon/microsoft-net-framework-assist/"&gt;Firefox&lt;/a&gt;. You can also use either the Command Line or a Powershell console, both using the same command as long as IE is your default browser. The fact that this method is rather IE-centric is not much of a drawback since every Windows machine has IE as its default browser in the base install which is the key Boxstarter scenario.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.mattwrock.com/image.axd?picture=launch.png"&gt;&lt;img style="background-image: none; padding-top: 0px; padding-left: 0px; margin: 0px 10px 0px 0px; display: inline; padding-right: 0px; border-width: 0px;" title="launch" src="http://www.mattwrock.com/image.axd?picture=launch_thumb.png" alt="launch" width="676" height="169" border="0" /&gt;&lt;/a&gt;All you need to remember is the Boxstarter domain and the Chocolatey package that drives your machine setup. In the above example, the package is called&amp;hellip;well&amp;hellip;example. Boxstarter probes both the public &lt;a href="http://chocolatey.org/"&gt;Chocolatey.org&lt;/a&gt; gallery and the &lt;a href="http://myget.org"&gt;Myget.org&lt;/a&gt; community &lt;a href="https://www.myget.org/gallery/boxstarter"&gt;boxstarter feed&lt;/a&gt; for a package ID named Example.&lt;/p&gt;
&lt;p&gt;This first installs a Boxstarter Click-Once Bootstrapper.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.mattwrock.com/image.axd?picture=install.png"&gt;&lt;img style="background-image: none; padding-top: 0px; padding-left: 0px; margin: 0px 10px 0px 0px; display: inline; padding-right: 0px; border-width: 0px;" title="install" src="http://www.mattwrock.com/image.axd?picture=install_thumb.png" alt="install" width="402" height="243" border="0" /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Be aware that on Windows 8, the Smart Screen filter will supply a somewhat frightening message stating that you have downloaded software that is not yet trusted.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.mattwrock.com/image.axd?picture=SmartScreen.png"&gt;&lt;img style="background-image: none; padding-top: 0px; padding-left: 0px; margin: 0px 10px 0px 0px; display: inline; padding-right: 0px; border-width: 0px;" title="SmartScreen" src="http://www.mattwrock.com/image.axd?picture=SmartScreen_thumb.png" alt="SmartScreen" width="608" height="163" border="0" /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Even though the Boxstarter Web Launcher is signed with an Authoritative certificate, it has not &amp;ldquo;&lt;a href="http://blogs.msdn.com/b/ieinternals/archive/2011/03/22/authenticode-code-signing-for-developers-for-file-downloads-building-smartscreen-application-reputation.aspx"&gt;gained enough reputation&lt;/a&gt;&amp;rdquo; to be considered safe. In theory, this should eventually go away. In the meantime, you need to click the &amp;ldquo;More info&amp;rdquo; link to get this dialog:&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.mattwrock.com/image.axd?picture=runanyway.png"&gt;&lt;img style="background-image: none; padding-top: 0px; padding-left: 0px; margin: 0px 10px 0px 0px; display: inline; padding-right: 0px; border-width: 0px;" title="runanyway" src="http://www.mattwrock.com/image.axd?picture=runanyway_thumb.png" alt="runanyway" width="601" height="161" border="0" /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Click the &amp;ldquo;Run Anyway&amp;rdquo; link to proceed. Next, unless you have UAC disabled, you need to give Boxstarter permissions to run with administrative privileges. Boxstarter needs these privileges in order to run all of the application installs, reboot and perform all actions you want it to to tweak your windows environment.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.mattwrock.com/image.axd?picture=Elevate.png"&gt;&lt;img style="background-image: none; padding-top: 0px; padding-left: 0px; margin: 0px 10px 0px 0px; display: inline; padding-right: 0px; border-width: 0px;" title="Elevate" src="http://www.mattwrock.com/image.axd?picture=Elevate_thumb.png" alt="Elevate" width="417" height="238" border="0" /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Next the normal Boxstarter session begins and prompts you for your windows account password:&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.mattwrock.com/image.axd?picture=console.png"&gt;&lt;img style="background-image: none; padding-top: 0px; padding-left: 0px; margin: 0px 10px 0px 0px; display: inline; padding-right: 0px; border-width: 0px;" title="console" src="http://www.mattwrock.com/image.axd?picture=console_thumb.png" alt="console" width="655" height="336" border="0" /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;Boxstarter stores the password you enter in a special place in windows designed specifically for this purpose. The password is stored in encrypted form and is never sent over the network or stored in plain text. This allows you to be automatically logged on whenever Boxstarter needs to reboot your system throughout the system installation.&lt;/p&gt;
&lt;p&gt;If you want to install a package without the risk of reboot and without this prompt, you can invoke boxstarter using this URL:&lt;/p&gt;
&lt;p&gt;HTTP://Boxstarter.org/package/nr/example&lt;/p&gt;
&lt;p&gt;Its all in the &amp;ldquo;/nr/&amp;rdquo;. This might be handy if you know no reboot is needed and perhaps you want to use Boxstarter because you know Chocolatey is not installed.&lt;/p&gt;
&lt;h2&gt;What happens next?&lt;/h2&gt;
&lt;p&gt;Boxstarter now installs Chocolatey and (if you are on windows 7 or server 2008 R2) .net4.0 if these are not already installed. It then proceeds to run the package you specified in the original URL. This is just a normal Chocolatey package. Boxstarter can run any Chocolatey package. What&amp;rsquo;s different when running the package in Boxstarter is the following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Boxstarter shuts down the windows update service and if installed, the SCCM client. These can often interfere with software installations.&lt;/li&gt;
&lt;li&gt;Boxstarter intercepts all Chocolatey install calls. If there is a pending reboot, boxstarter invokes a system reboot and ensures that it will be reinvoked first thing on startup.&lt;/li&gt;
&lt;li&gt;Boxstarter examines all Chocolatey failures and if these are standard MSI Pending reboot failures, it will like above, restart your system and try again after restarting.&lt;/li&gt;
&lt;li&gt;Boxstarter runs the entire installation as admin to avoid prompts for permissions elevation or errors complaining about insufficient permissions.&lt;/li&gt;
&lt;li&gt;Boxstarter imports the &lt;a href="https://boxstarter.codeplex.com/documentation"&gt;Boxstarter.Winconfig&lt;/a&gt; powershell module making all of its CmdLets available that provide various helpers for customizing windows settings (enabling remote desktop, customizing windows explorer defaults, icon sizes, etc.). The most important feature in this module is the ability to run all critical windows updates. A routine requirement when setting up a new system.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;What might a Chocolatey package look like for a Boxstarter install?&lt;/h2&gt;
&lt;p&gt;Here is an example:&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt;&lt;span style="font-size: 9.8pt;"&gt;Update&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: 9.8pt;"&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: 9.8pt;"&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt;ExecutionPolicy Unrestricted Move&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;LibraryDirectory &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #a31515;"&gt;"Personal"&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #a31515;"&gt;"$env:UserProfile\skydrive\documents"&lt;/span&gt;&lt;/span&gt; &lt;span style="color: #000000;"&gt;Set&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;ExplorerOptions &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;showHidenFilesFoldersDrives &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;showProtectedOSFiles &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt;showFileExtensions Enable&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt;RemoteDesktop cinstm VisualStudioExpress2012Web cinstm fiddler cinstm mssqlserver2012express cinstm git&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;credential&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt;winstore cinstm console&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt;devel cinstm skydrive cinstm poshgit cinst Microsoft&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Hyper&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;V&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;All &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt;source windowsFeatures cinst IIS&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;WebServerRole &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt;source windowsfeatures cinst TelnetClient &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt;source windowsFeatures Install&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;ChocolateyPinnedTaskBarItem &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #a31515;"&gt;"$env:programfiles\console\console.exe"&lt;/span&gt;&lt;/span&gt; &lt;span style="color: #000000;"&gt;copy&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;item (Join&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Path (Get&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;PackageRoot(&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$MyInvocation&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;)) &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #a31515;"&gt;'console.xml'&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;) &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Force &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$env:appdata&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt;\console\console.xml Install&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;ChocolateyVsixPackage xunit http:&lt;/span&gt;&lt;span style="color: #808080;"&gt;&lt;span style="background-color: #ececec;"&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;/&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;/&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;visualstudiogallery.msdn.microsoft.com&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;/&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;463c5987&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;f82b&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;46c8&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;a97e&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;b1cde42b9099&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;/&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;file&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;/&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;66837&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;/&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;1&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;/&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="font-size: 9.8pt;"&gt;&lt;span style="color: #000000;"&gt;xunit.runner.visualstudio.vsix Install&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;WindowsUpdate &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border-width: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;AcceptEula&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;This is a relatively simple setup. Here is what will happen:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The user&amp;rsquo;s powershell execution policy will be permanently set to unrestricted.&lt;/li&gt;
&lt;li&gt;The MyDocuments folder is moved to Skydrive (I always do this and it is incredibly convenient since my docs (including things like powershell profile) are synced between machines and makes the risk of a machine failure less ominous).&lt;/li&gt;
&lt;li&gt;The Windows explorer settings are set to a developer sane level.&lt;/li&gt;
&lt;li&gt;Remote Desktop is enabled.&lt;/li&gt;
&lt;li&gt;Several typical developer applications are installed including Visual Studio and Sql server. When installed together these two often make for a &amp;ldquo;reboot perfect storm.&amp;rdquo; All of their dependent packages will be installed as well like GIT for poshgit and the .net 4.5 framework for Visual Studio.&lt;/li&gt;
&lt;li&gt;Hyper-V, IIS and the Telnet client are installed&lt;/li&gt;
&lt;li&gt;I &amp;ldquo;pin&amp;rdquo; &lt;a href="http://sourceforge.net/projects/console/"&gt;Console&lt;/a&gt;, my favorite command line console, to the task bar and copy its configuration file with my preferred settings that I embedded in the chocolatey package to the directory where it expects to find it.&lt;/li&gt;
&lt;li&gt;I install the XUnit test runner Visual Studio extension.&lt;/li&gt;
&lt;li&gt;Lastly I install all critical windows updates.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Chances are this will include at least one or two reboots in windows 8 and several more in Windows 7. Boxstarter will reboot when needed and then simply rerun the package after restart. Chocolatey helps us from installing packages more than once. On subsequent runs it knows if we installed something previously and will just skip to the next install. This does mean that any custom script we add, and we can add any powershell we want, must be repeatable.&lt;/p&gt;
&lt;h2&gt;I thought Powershell 4&amp;rsquo;s Desired State Configuration solves this&lt;/h2&gt;
&lt;p&gt;&lt;a href="http://technet.microsoft.com/en-us/library/dn249912.aspx"&gt;Desired state configuration&lt;/a&gt; is the flagship feature shipping with Powershell 4 on Windows 8.1 and Server 2012 R2. It is no less than very cool and will indeed change the way we do machine configuration in Windows at last. It allows you to create declarative configuration files hat describe exactly how you want a machine to look and then tells one or more machines in your enterprise, look like this and do whatever it takes to make that happen.&lt;/p&gt;
&lt;p&gt;The gaps that Boxstarter tries to fill here are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Backward compatibility back to windows 7 and server 2008 R2.&lt;/li&gt;
&lt;li&gt;Support for client systems. DSC is currently strongly targeting server infrastructure&lt;/li&gt;
&lt;li&gt;Tooling. Eventually, I want people to be able to use Boxstarter who have no knowledge of powershell or any scripting for that matter.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;What's next for Boxstarter?&lt;/h2&gt;
&lt;p&gt;I&amp;rsquo;ve been on a bit of a oss hiatus lately with my day job keeping me quite busy during non daylight hours, but I have had some time lately to do some polishing and also make some headway into another goal I have for Boxstarter: Easily deploying a Boxstarter install to a new VM. If you are familiar with Vagrant, a great VM environment setup platform for VirtualBox, VMWare and AWS then you can picture where I am going with this. I&amp;rsquo;d like to bring the same (or atleast very similar) capabilities to Hyper-V and windows Azure VMs.&lt;/p&gt;
&lt;p&gt;This week I wrote a test script to help me automate testing Boxstarter packages and Boxstarter itself. Its just part of my PSake build file now:&lt;/p&gt;
&lt;p&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt;&lt;span style="font-size: 9.8pt;"&gt;task Test&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: 9.8pt;"&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;VM &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;requiredVariables &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #a31515;"&gt;"VmName"&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;,&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #a31515;"&gt;"package"&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-size: 9.8pt;"&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt;{ &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$vm&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt; Get&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;VM &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$VmName&lt;/span&gt;&lt;/span&gt; &lt;span style="color: #000000;"&gt; Restore&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;VMSnapshot &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$vm&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Name &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$vm&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;.ParentSnapshotName &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Confirm:&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$false&lt;/span&gt;&lt;/span&gt; &lt;span style="color: #000000;"&gt; Start&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;VM &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$VmName&lt;/span&gt;&lt;/span&gt; &lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$creds&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt; Get&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Credential &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Message &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #a31515;"&gt;"$vmName credentials"&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;UserName &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #a31515;"&gt;"$env:UserDomain\$env:username"&lt;/span&gt;&lt;/span&gt; &lt;span style="background-color: #ececec;"&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #ff4500;"&gt;$me&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #808080;"&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #ff4500;"&gt;$env:computername&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; &lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$remoteDir&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$baseDir&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;.replace(&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #a31515;"&gt;':'&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;,&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #a31515;"&gt;'$'&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt;) &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$encryptedPass&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt; convertfrom&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;securestring &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;securestring &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$creds&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt;.password &lt;/span&gt;&lt;span style="background-color: #ececec;"&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #ff4500;"&gt;$modPath&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #808080;"&gt;=&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #a31515;"&gt;"\\$me\$remoteDir\Boxstarter.Chocolatey\Boxstarter.Chocolatey.psd1"&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; &lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$script&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;=&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt; { Import&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Module &lt;/span&gt;&lt;span style="background-color: #ececec;"&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #ff4500;"&gt;$args&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #808080;"&gt;[&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #008080;"&gt;0&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #808080;"&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; &lt;span style="color: #000000;"&gt; Invoke&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;ChocolateyBoxstarter &lt;/span&gt;&lt;span style="background-color: #ececec;"&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #ff4500;"&gt;$args&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #808080;"&gt;[&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #008080;"&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #808080;"&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Password &lt;/span&gt;&lt;span style="background-color: #ececec;"&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #ff4500;"&gt;$args&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #808080;"&gt;[&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #008080;"&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="color: #808080;"&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; &lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt; } Write&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Host &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #a31515;"&gt;"Waiting for $vmName to start..."&lt;/span&gt;&lt;/span&gt; &lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #0000ff;"&gt;do&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt; {Start&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Sleep &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="color: #000000;"&gt;milliseconds 100} &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #0000ff;"&gt;until&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt; ((Get&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;VMIntegrationService &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$vm&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt; | ?{&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$_&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;.name &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-eq&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #a31515;"&gt;"Heartbeat"&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;}).PrimaryStatusDescription &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-eq&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #a31515;"&gt;"OK"&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="font-family: Consolas;"&gt;&lt;span style="font-size: 9.8pt;"&gt;&lt;span style="color: #000000;"&gt;) Write&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Host &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #a31515;"&gt;"Importing Module at $modPath"&lt;/span&gt;&lt;/span&gt; &lt;span style="color: #000000;"&gt; Invoke&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Command &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;ComputerName &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$vmName&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Credential &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$creds&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Authentication Credssp &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;ScriptBlock &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$script&lt;/span&gt;&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #808080;"&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;Argumentlist &lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$modPath&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;,&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$package&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;,&lt;/span&gt;&lt;span style="vertical-align: baseline; outline-width: 0px; outline-style: none; margin: 0px; outline-color: invert; border: 0px; padding: 0px;"&gt;&lt;span style="background-color: #ececec; color: #ff4500;"&gt;$creds&lt;/span&gt;&lt;/span&gt;&lt;span style="color: #000000;"&gt;.Password }&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;This takes a given VM and reverts it to its parent snapshot and then uses Powershell remoting to run the install. Take a look at &lt;a href="https://gist.github.com/mwrock/698f4787eaa64f222422"&gt;this gist&lt;/a&gt; I wrote with a function to test pure Chocolatey packages. It includes some comments on how to setup the remoting.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;d like to improve on this by cloning a VM from an existing VHD, then run the Boxstarter install on the VM taking over the mess of setting up the remoting and VM networking. We&amp;rsquo;ll see how that shapes up.&lt;/p&gt;
&lt;h2&gt;Feedback&lt;/h2&gt;
&lt;p&gt;If you have the chance to try Boxstarter out, I&amp;rsquo;m very interested to hear how he experience is. What is confusing, what does not work or what you would really like to see added as a feature. Please feel free to utilize the &lt;a href="http://boxstarter.codeplex.com"&gt;Codeplex&lt;/a&gt; Discusion and Issues features to voice these. You can also find complete documentation on the &lt;a href="https://boxstarter.codeplex.com/documentation"&gt;Boxstarter.Codplex.com documentation wiki&lt;/a&gt;.&lt;/p&gt;</content>
  <ispublished>True</ispublished>
  <isdeleted>False</isdeleted>
  <iscommentsenabled>True</iscommentsenabled>
  <pubDate>2013-08-05 02:17:00</pubDate>
  <lastModified>2013-11-30 23:00:07</lastModified>
  <raters>0</raters>
  <rating>0</rating>
  <slug>Setup-a-new-machine-with-just-a-URL-and-Chocolatey-package</slug>
  <tags />
  <comments />
  <categories>
    <category>219109f8-7b0b-459b-8f25-9ce747eb0851</category>
  </categories>
  <notifications />
</post>